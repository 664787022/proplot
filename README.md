# SkyPlot
## Overview

This library provides helpful and versatile plotting utilities to make the process of crafting publication-quality graphics with `matplotlib` smoother. I recommend importing the package with
```
import skyplot as plot
```
Most of the features below derive from the **`subplots`** command, inspired by the `pyplot` command of the same name. This generates a scaffolding of axes and panels.

Next is the **`format`** method. This method is assigned to every axes generated by `subplots`, and can be used to control the look of your axes with a plethora of keyword arguments. Why do this?
  
Quick overview of additional features:

  * Geometry: Specify axes aspect ratios without messing up subplot spacing. Panels and inter-axes spaces are held *fixed* in inches, while the figure width or height and individual axes sizes are allowed to change. Border space is trimmed (expanded) without messing with inter-axes spacing. *Incredibly* useful for meeting journal figure-size requirements.'
  * Colors: Provided group of perceptually distinct named colors, powerful colormap-generating tools, ability to trivially swap between "color cycles" and "colormaps". A few new, beautiful colormaps and color cycles are provided. Create colorbars from lists of lines or color strings.
  * Maps: Integration with basemap *and* cartopy. Generate arbitrary grids of map projections in one go. Switch between basemap and cartopy painlessly. Add geographical features as part of the `format` process.

## Installation
```
pip install git+https://github.com/lukelbd/skyplot.git#egg=skyplot
```

## How is this different from seaborn?
There is already a great matplotlib wrapper called [seaborn](https://seaborn.pydata.org/). What makes this project different? While some of the utilties here were inspired by seaborn (in particular `colors.py` takes its inspiration from seaborn's `palettes.py`), the goals for this project are quite different. I endeavored to create a package that was *extremely* efficient at the task of **crafting beautiful, precise, publication-ready figures, and no more**.

When using SkyPlot, your data should be analysed *prior* to plotting, while in seaborn the tasks of data analysis and plotting are generally wrapped into one. And as an atmospheric scientist, the datasets I use usually do not lend themselves to fitting in a simple DataFrame -- so this was not particularly useful for me. For data analysis tools I use in my physical climatology research, check out my [ClimPy](https://github.com/lukelbd/climpy`) project (still in preliminary stages).

By focusing on this one task -- creating beautiful figures -- I've created a number of **immensely powerful** features well beyond the scope of `seaborn` as a data analysis-and-visualization package. While some `rc` defaults have been improved, these tools are not intended to give you the final product on a silver platter. Instead, I expect you to tinker with your plots. This package simply makes this process much, much easier.

## Donation
This package took a shocking amount of time to write. If you've found it useful, feel free to buy me a cup of coffee :)

[![Donate](https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif)](https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=5SP6S8RZCYMQA&source=url)

# Documentation
## The `subplots` command
To generate complex grids, pass a 2D array of numbers corresponding to unique subplots. Use zero to allot empty space. For example, `subplots(array=[[1,2],[1,3]])` creates a grid with one tall plot on the left, and two smaller plots on the right, while `subplots(array=[[1,1,1],[2,0,4]])` creates a grid with one long plot on top and two smaller plots on the bottom with a gap in the middle

Pass no arguments to generate default single-axes figure (1 row, 1 column), or use `nrows` and `ncols` to generate simple subplot grids -- e.g. `nrows=2` creates two rows with one column. Note that if axes numbers were not declared with `array`, the subplots are automatically numbered from 1 to n (row major).
      
Returns two arguments: the figure, and a list of axes. If only one axes was drawn, returns the axes instead of a singleton list.

Precise control of layout: control figure width/height with kwargs `width/height`, vertical/horizontal space between axes with `wspace/hspace`, panel widths with `bwidth/rwidth`, inner-panel widths with `ihwidth/iwwidth`, inner-panel spacing with `ihspace/iwspace`, ratios for axes column widths (row heights) with `wratios/hratios`, ...

Automatic sizing: specify a width (height) with a subplot *aspect ratio* (e.g. `aspect=1`, the default), and `subplot` will automatically determine the necessary height (width) required to preserve that aspect ratio.

Integrated journal standards: for example, `width='ams1'` selects the smallest American Meteorological Society standard figure width.

## Inner and outer "panels"
Use `[bottom|right]panel=True` to allot space for panels spanning all columns (rows) on the bottom (right). Use `[bottom|right]panels=True` to allot space for one panel per column (row). Use `[bottom|right]panels=[n1,n2,...]` to allot space for panels that can span adjacent columns (rows). These add `fig.[bottom|right]panel` attributes to the figure `fig` (access the nth panel with `fig.[bottom|right]panel[n]`).

Example: If your subplot has 3 columns, passing `bottompanels=[1,2,2]` draws one panel for the first column and a second panel spanning the next two.

Convenience feature: `[bottom|right][colorbar|legend][s]=True` to modify the panel width and spacing to be *suitable for colorbars/legends*, e.g. `rightcolorbar=True`.

Use `fig.[bottom|right]panel.[legend|colorbar]` to fill the axes with a legend or colorbar. You must supply the `legend` with a list of handles, and supply `colorbar` with a mappable, list of lines, or list of colors. Alternatively, feel free to draw on the panels with `plot`, `contourf`, etc. like normal.

## Mapping toolkit integration
For projection subplots, specify `projection='name'` with either `package='basemap'` or `package='cartopy'`. Extra arguments to `subplot` will be passed to the `basemap.Basemap` and `cartopy.crs.Projection` classes (the relevant cartopy class will be selected based on the `'name'` string).

Control which subplots are projection subplots with `projection='name'`or  `projection={1:'name1', (2,3):'name2', 4:'name3'}`, where numbers correspond to the subplot array number.

Access basemap plotting utilities directly as an axes method, thanks to the `BasemapAxes` subclass. Several plotting methods are also overridden to fix issues with the "seam" on the edge of the map (data is circularly rolled and interpolated to map edges).
   
## The `format` command
To modify an axes property (e.g. an x-axis label) with the default API, you normally have to use a bunch of one-liner `pyplot` commands (or method calls on axes/axis objects). This can get repetitive and quite verbose, resulting in lots of boilerplate code.

Now, you can pass all of these settings to `format`. Instead of having to remember the name of the function, whether it's attached to `pyplot` or an object instance, and the order/names of the arguments, you just have to remember one thing -- the name of the keyword argument. The `format` method also abstracts away some inconsistencies and redundancies in the matplotlib API -- now, There's Only One (obvious) Way To Do It.

Example usage:

```
ax.format(xlabel='time (seconds)', ylabel='temperature (K)', title='20th century sea-surface temperature')
```

Axis options:

```
xgrid, ygrid,
xspineloc, yspineloc,
xtickloc, ytickloc, xtickdir, ytickdir,
xtickminor, ytickminor, xgridminor, ygridminor,
xticklabeldir, yticklabeldir,
xtickrange, ytickrange,
xlim, ylim, xreverse, yreverse, xdates, ydates,
xscale, yscale, xscale_kw, yscale_kw,
xlabel, ylabel, xlabel_kw, ylabel_kw
xlocator, xminorlocator, xlocator_kw, xminorlocator_kw
ylocator, yminorlocator, ylocator_kw, yminorlocator_kw
xformatter, yformatter, xformatter_kw, yformatter_kw
```

Titling options:

```
suptitle, suptitle_kw
title, titlepos, title_kw,
abc, abcpos, abcformat, abc_kw
```

Mapping options:

```
latlabels, lonlabels,
latlocator, latminorlocator, lonlocator, lonminorlocator 
land, ocean, coastline, oceans, coastlines, continents,
```

Axes canvas options:

```
hatch, color, facecolor, linewidth
```

## Axis scales, tick formatters, and tick locators
Added "*inverse*" axis scale -- invoke with `[x|y]scale='inverse'`. Useful for, e.g., having wavenumber and wavelength on opposite sides of the same plot.

Added *sine-weighted* and *Mercator* axis scales. Invoke with `[x|y]scale='sine'` and `[x|y]scale='mercator'`.

Added scale factory that can create scales with arbitrary *cutoffs* and "*zoom-ins/zoom-outs*".

Added new default `Formatter` class for ticklabels, which renders numbers into the style you'll want 90% of the time.

Use `formatter='[lat|deglat|lon|deglon|deg]'` to format axis labels with cardinal direction indicators or degree symbols (as denoted by the names).

Use `locator=N` to tick every `N` data values. Use `locator=[array]` to tick specific locations. Use `locator='[string]'` to use any of the `matplotlib.ticker` locators, e.g. `locator='month'` or `locator='log'`.

Use `plot.arange` for generating lists of contours, ticks, etc. -- it's like `np.arange`, but is **endpoint-inclusive**.

## Enhanced settings management
Use `plot.rc` as your one-stop shop for changing global settings. This is an instance of the new `rc_configurator` class, created on import. It can be used to change built-in `matplotlib.rcParams` settings, a few custom "`rcSpecial`" settings, and some special "global" settings that modify several other settings at once.

Example: Use `plot.rc['linewidth'] = 2` or `plot.rc.linewidth = 2` to increase the thickness of axes spines, major tick marks, and minor tick marks. Use `plot.rc['color'] = 'red'` or `plot.rc.color = 'red'` to make all spines, tick marks, tick labels, and axes labels red. Use `plot.rc['small']` and `plot.rc['large']` to control axes font sizes. Update any arbitrary `rcParam` with e.g. `plot.rc['legend.frameon'] = False`.

Use `plot.rc.reset()` to reset everything to the initial state. This is also called every time a figure's `draw` method is invoked (e.g. when a figure is rendered by the matplotlib backend or saved to file).

## Colormaps, color cycles, and color names
Added **new colormap class** analagous to `LinearSegmentedColormap`, called `PerceptuallyUniformColormap`, which interpolates through hue, saturation, and luminance space (with hues allowed to vary circularly). Choose from either of 4 HSV-like colorspaces: classic HSV, perceptually uniform HCL, or HSLuv/HPLuv (which are forms of HCL adapted for convenient use with colormaps; see [this link](http://www.hsluv.org/comparison/)).

Generate perceptually uniformly varying colormaps on-the-fly by passing a **dictionary** to any plotting function that accepts the `cmap`keyword argument -- for example, `ax.contourf(..., cmap=dict(h=hues, l=lums, s=sats))`. The arguments can be lists of numbers or **color strings**, in which case the corresponding channel value (hue, saturation, or luminance) for that color will be looked up and applied.

Create single-hue colormaps on-the-fly by passing a string that looks like `cmap='name'` or `cmap='nameXX'`, where `name` is any registered color string (the corresponding hue will be looked up) and `XX` is the lightness value.

New colormaps have been added as `PerceptuallyUniformColormap` instances. New color cycles are also available (i.e. the automatic color order when drawing multiple lines). Cycle can be set with `plot.rc.cycle = 'name'` or by passing `cycle='name'` to any command that plots lines/patches (`plot`, `bar`, etc.).

The distinction between "colormap" and "color cycle" is now fluid -- all color cycles are defined as `ListedColormaps`, and cycles can be generated on the fly from `LinearSegmentedColormap`s by just specifying the colormap name as the cycler.

New colors have been added from XKCD colors, crayon colors, and Open Color web-design color palette. Colors that aren't sufficiently perceptually distinct are eliminated, so its easier to pick from the color table.

Use functions `cmap_show`, `color_show`, and `cycle_show` to visualize available colormaps, named colors, and color cycles. Functions will automatically save PDFs in the package directory.

## Revised underlying issues with contour and pcolor commands
Flipped the unnatural default used by `pcolor` and `contour` functions: that `0`th dimension of the input array is `y`-axis, `1`st dimension is `x`-axis. More intuitive to enter array with `0`th dimension on `x`-axis.

The well-documented [white-lines-between-filled-contours](https://stackoverflow.com/q/8263769/4970632)nd [white-lines-between-pcolor-rectangles](https://stackoverflow.com/q/27092991/4970632) problems are fixed by automatically changing the edgecolors when `contourf`, `pcolor`, and `pcolormesh` are called.
